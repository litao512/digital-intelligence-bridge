# 通用工具箱界面优化设计文档

**日期**: 2025-02-18
**主题**: 医疗健康行业托盘应用框架界面优化
**版本**: 1.0

---

## 1. 项目背景与目标

### 1.1 项目定位
医疗健康行业通用的托盘入口应用，采用插件化架构，各功能模块以插件形式动态加载。

### 1.2 当前架构
- 托盘应用框架（基础平台）
- 待办事项模块（第一个插件）
- Web 应用集成
- 设置模块

### 1.3 优化目标
1. 建立统一的视觉设计系统
2. 实现插件仓库首页（默认视图）
3. 模块统计信息内聚化（各模块独立显示）
4. 支持动态导航菜单加载
5. 提升交互体验和响应速度

---

## 2. 架构设计

### 2.1 应用结构

```
通用工具箱 (医疗健康版)
├── 首页/插件仓库 (默认视图) - 内嵌浏览器
│   └── WebView 显示插件市场页面
├── 待办事项 (插件模块)
│   ├── 任务列表
│   └── 模块内统计面板
├── Web 应用 (插件模块)
│   └── 已集成的 Web 应用列表
├── 患者管理 (占位)
├── 日程安排 (占位)
└── 设置
    └── 应用配置
```

### 2.2 视图切换逻辑

| 导航项 | 视图类型 | 内容说明 |
|-------|---------|---------|
| **首页** | WebView | 插件仓库，默认显示 |
| **待办事项** | 原生界面 | 任务管理+模块统计 |
| **Web 应用** | 原生界面 | 集成的 Web 应用列表 |
| **患者管理** | 占位 | 未来插件预留 |
| **日程安排** | 占位 | 未来插件预留 |
| **设置** | 原生界面 | 应用配置页面 |

### 2.3 动态导航菜单

导航菜单支持从配置文件/服务端动态加载：

```csharp
public class MenuItemConfig
{
    public string Id { get; set; }           // 唯一标识
    public string Name { get; set; }         // 显示名称
    public string Icon { get; set; }         // 图标字体
    public string Type { get; set; }         // native / webview
    public bool IsInstalled { get; set; }    // 是否已安装
    public int Order { get; set; }           // 排序
}
```

---

## 3. 视觉设计系统

### 3.1 色彩系统 (Semi Design)

| 用途 | 颜色值 | 使用场景 |
|-----|-------|---------|
| **主色** | `#0077FA` | 主要按钮、链接、选中状态 |
| **成功色** | `#3BB346` | 完成状态、成功提示 |
| **警告色** | `#FCA321` | 进行中、警告提示 |
| **错误色** | `#F93920` | 逾期、删除操作、错误提示 |
| **页面背景** | `#F0F2F5` | 主内容区背景 |
| **卡片背景** | `#FFFFFF` | 卡片、面板背景 |
| **导航背景** | `#1F2329` | 左侧导航栏背景 |
| **文字主色** | `#1F2329` | 标题、正文 |
| **文字辅助** | `#8F959E` | 描述、提示信息 |
| **分隔线** | `#E6E8EB` | 边框、分隔线 |

### 3.2 字体系统

| 层级 | 字号 | 字重 | 用途 |
|-----|------|-----|------|
| 页面标题 | 24px | Bold (700) | 页面主标题 |
| 区块标题 | 18px | SemiBold (600) | 卡片标题、分组标题 |
| 列表标题 | 16px | Medium (500) | 列表项标题 |
| 正文 | 14px | Normal (400) | 一般文字 |
| 辅助文字 | 12px | Normal (400) | 时间、标签 |

### 3.3 间距系统

| 类型 | 数值 | 用途 |
|-----|------|-----|
| 大间距 | 24px | 区块之间 |
| 中间距 | 16px | 卡片内部间距 |
| 小间距 | 12px | 元素之间 |
| 微间距 | 8px | 紧密排列 |

### 3.4 圆角系统

| 类型 | 数值 | 用途 |
|-----|------|-----|
| 大圆角 | 12px | 卡片、面板 |
| 中圆角 | 8px | 按钮、输入框 |
| 小圆角 | 6px | 标签、徽章 |
| 按钮圆角 | 4px | 小型按钮 |

### 3.5 阴影系统

| 类型 | 阴影值 | 用途 |
|-----|-------|------|
| 默认阴影 | `0 2px 8px rgba(0,0,0,0.08)` | 卡片默认状态 |
| 悬停阴影 | `0 4px 16px rgba(0,0,0,0.12)` | 卡片悬停状态 |
| 弹窗阴影 | `0 8px 24px rgba(0,0,0,0.16)` | 下拉菜单、弹窗 |

---

## 4. 界面设计详情

### 4.1 左侧导航栏

#### 布局
- 宽度: 240px
- 背景: `#1F2329`
- 内边距: 16px

#### 结构
```
┌─────────────────────────┐
│  🏥 通用工具箱           │  ← Logo区 (高60px)
│     医疗健康版           │
├─────────────────────────┤
│  🔍 首页                │  ← 默认选中
│  📋 待办事项            │
│  🌐 Web 应用            │
│  👤 患者管理            │  ← 占位 (灰色)
│  📅 日程安排            │  ← 占位 (灰色)
├─────────────────────────┤
│  ⚙️ 设置               │  ← 底部分隔
└─────────────────────────┘
```

#### 交互
- 选中项: 左侧 3px 蓝色指示条 `#0077FA`
- 悬停: 背景变为 `#2F343C`
- 未安装插件: 图标和文字降低透明度 (50%)

### 4.2 首页/插件仓库

#### 布局结构
```
┌─────────────────────────────────────────────────────┐
│  插件仓库                                    [搜索框] │  ← 标题栏
├─────────────────────────────────────────────────────┤
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │                                             │   │
│  │           WebView 区域                      │   │
│  │         (显示插件仓库页面)                   │   │
│  │                                             │   │
│  │      开发阶段使用 baidu.com 模拟             │   │
│  │                                             │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
└─────────────────────────────────────────────────────┘
```

#### 功能说明
- 页面标题: "插件仓库"
- 右上角搜索框（预留，可先隐藏）
- WebView 占满剩余空间
- 默认加载 `https://www.baidu.com` 进行测试

### 4.3 待办事项模块

#### 布局调整
统计面板从全局移到模块内部：

```
┌─────────────────────────────────────────────────────┐
│  待办事项                                           │  ← 标题栏
├─────────────────────────────────────────────────────┤
│  [总计5] [进行中3] [已完成2] [已逾期1]              │  ← 模块内统计
├─────────────────────────────────────────────────────┤
│  ┌──────────┐ ┌─────────────────────────────────┐  │
│  │          │ │  [搜索] [筛选▼] [清除筛选]       │  │
│  │  添加    │ │                                 │  │
│  │  新任务  │ │  ┌─────────────────────────┐   │  │
│  │          │ │  │ ☑ 任务标题              │   │  │
│  │  [表单]  │ │  │ 描述...  [高] [工作]    │   │  │
│  │          │ │  │ 📅 12-30                │   │  │
│  └──────────┘ │  └─────────────────────────┘   │  │
│               │                                 │  │
│               └─────────────────────────────────┘  │
└─────────────────────────────────────────────────────┘
```

#### 统计面板样式
- 水平排列四个统计项
- 每个统计项: 数字(大) + 标签(小)
- 不同颜色区分状态

### 4.4 Web 应用模块

保持现有设计，应用新的视觉系统（颜色、圆角、阴影）

---

## 5. 交互动画设计

### 5.1 页面切换动画

```xml
<!-- 页面切换：淡入淡出 -->
<PageTransition Duration="0:0:0.2">
    <FadeTransition />
</PageTransition>
```

- 持续时间: 200ms
- 缓动函数: EaseInOutQuad

### 5.2 按钮交互

#### 悬停效果
- 背景色变化: 150ms 过渡
- 轻微上浮: `translateY(-1px)`

#### 点击效果
- 缩放: `scale(0.98)`
- 持续时间: 100ms

### 5.3 卡片交互

#### 悬停效果
- 阴影加深（默认→悬停）
- 轻微上浮: `translateY(-2px)`
- 持续时间: 200ms

### 5.4 列表项动画

#### 删除动画
- 滑出: `translateX(100%)`
- 淡出: `opacity 0`
- 高度收缩: `height 0`
- 持续时间: 300ms

### 5.5 Toast 通知

#### 显示动画
- 从顶部滑入: `translateY(-100%) → translateY(0)`
- 淡入: `opacity 0 → 1`
- 持续时间: 300ms

#### 自动消失
- 显示时长: 3秒
- 消失动画: 淡出 + 上滑
- 持续时间: 200ms

#### 位置
- 顶部居中
- 距离顶部: 20px
- 最大宽度: 400px

---

## 6. 空状态设计

### 6.1 待办列表为空

```
┌─────────────────────────────┐
│                             │
│         [插图]              │
│                             │
│      暂无待办事项            │
│   点击左侧添加新任务         │
│                             │
│      [+ 添加任务]           │
│                             │
└─────────────────────────────┘
```

- 插图: 使用简单的图标或 SVG
- 文字: 18px, 灰色
- 按钮: 主色调，引导操作

### 6.2 Web 应用为空

类似设计，提示"暂无集成的 Web 应用"

---

## 7. 响应式设计

### 7.1 窗口尺寸适配

| 断点 | 宽度范围 | 布局调整 |
|-----|---------|---------|
| 大屏 | ≥1400px | 导航固定展开 |
| 中屏 | 1000-1399px | 默认布局 |
| 小屏 | <1000px | 可折叠导航 |

### 7.2 最小窗口尺寸
- 宽度: 900px
- 高度: 600px

---

## 8. 技术实现要点

### 8.1 需要创建的组件

1. **ToastNotificationService** - 全局 Toast 通知服务
2. **ViewTransitionService** - 视图切换动画服务
3. **PluginRepositoryView** - 插件仓库视图（WebView 封装）
4. **EmptyStateControl** - 空状态控件
5. **StatisticCard** - 统计卡片组件

### 8.2 需要修改的文件

1. `MainWindow.axaml` - 布局结构调整
2. `MainWindow.axaml.cs` - 导航逻辑调整
3. `MainWindowViewModel.cs` - 移除全局统计，添加当前视图状态
4. `App.axaml` - 添加动画资源和样式
5. 创建新的样式资源文件

### 8.3 依赖项

- Semi.Avalonia (已存在)
- 可能需要添加 Avalonia 动画相关包

---

## 9. 开发阶段划分

### 阶段一：基础结构调整
- 首页改为 WebView 显示 baidu.com
- 待办统计移到模块内部
- 添加占位菜单项

### 阶段二：视觉系统应用
- 统一配色方案
- 统一字体和间距
- 统一圆角和阴影

### 阶段三：交互动画
- Toast 通知系统
- 页面切换动画
- 按钮/卡片悬停效果

### 阶段四：细节完善
- 空状态设计
- 加载状态
- 错误提示

---

## 10. 验收标准

- [ ] 首页默认显示 WebView，加载 baidu.com
- [ ] 切换到待办事项时显示模块内统计面板
- [ ] 导航栏有 5+ 个菜单项（含占位）
- [ ] 所有按钮有悬停效果
- [ ] 页面切换有淡入淡出动画
- [ ] Toast 通知正常工作
- [ ] 配色符合 Semi Design 规范
- [ ] 空状态显示正确

---

**设计文档版本**: 1.0
**最后更新**: 2025-02-18
**作者**: Claude
