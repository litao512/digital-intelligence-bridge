# 2026-02-19 技术债清单（运行时配置与验收）

## 范围
- 目标：把 `appsettings.runtime.json` 的临时方案逐步演进为可审计、可轮换、可自动化验收的方案。
- 状态：记录于本次版本后续迭代待办。

## 清单

| ID | 技术债项 | 风险 | 建议方案 | 优先级 | 状态 |
|---|---|---|---|---|---|
| TD-001 | 客户端本地明文保存 `AnonKey` | 机器被入侵或误拷贝时，存在泄露风险 | 引入远程签名配置下发，客户端只缓存短时有效配置；增加过期时间和版本字段校验 | 高 | 待办 |
| TD-002 | 运行时配置脚本仅支持一次性写入 | 密钥轮换时易人工失误 | 增加 `-Rotate` 模式：备份旧配置、写入新配置、校验后再切换 | 中 | 待办 |
| TD-003 | 缺少“托盘图标可用性”的自动化单测 | UI 自检逻辑回归只能依赖手工发现 | 为 `IsTrayIconAvailable` 抽离可测试服务并补单测 | 中 | 待办 |
| TD-004 | CI 尚未覆盖真实 Supabase 连通性 | 线上配置改动无法第一时间暴露 | 新增 `workflow_dispatch` + secrets 的受控连通性任务（仅手动触发） | 中 | 已完成（2026-02-19） |
| TD-005 | 手工回归项依赖人工记录 | 回归结果不可追溯 | 统一使用 `docs/plans/*-regression-checklist.md` 并在 PR 中强制附勾验结果 | 低 | 已完成（2026-02-19） |

## 验收口径（下一阶段）
- 代码侧：Debug/Release 构建 + 单测全绿。
- 配置侧：运行时配置生成、加载、回退路径均可验证。
- 联调侧：`dib.todos` API 可读写，且 schema header 行为符合预期。
